<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="bower_components/jquery/jquery.js"></script>
    <script src="bower_components/select2/select2.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="bower_components/underscore/underscore.js"></script>

    <link href="bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="bower_components/bootstrap/dist/css/bootstrap-theme.css" rel="stylesheet" type="text/css" media="all">
    <link href="bower_components/select2/select2.css" rel="stylesheet" type="text/css" media="all">
    <link href="bower_components/select2/select2-bootstrap.css" rel="stylesheet" type="text/css" media="all">

    <link href="css/main.css" rel="stylesheet" type="text/css" media="all">

    <script src="lib/base64.js"></script>

    <script src="src/config.js"></script>
    <script src="src/jquery.drugsearch.js"></script>
    <script src="src/jquery.formsearch.js"></script>
    <script src="src/jquery.createrequest.js"></script>
    <script src="src/jquery.dashboard.js"></script>
    <script src="src/jquery.cmmhelp.js"></script>

    <script>
      $(function () {
        $('#drug-search').drugSearch({ staging: true });

        $('#form-search').formSearch({ staging: true });

        $('#start-request').createRequest({
          staging: true,
          success: function (data, status, xhr) {
            // Temporarily store data in localstorage, to be accessed later
            var ids = JSON.parse(localStorage.getItem('ids')) || [];
            ids.push(data.request.id);
            localStorage.setItem('ids', JSON.stringify(ids));

            alert('PA request created successfully!');
          },
          error: function (data, status, xhr) {
            alert('There was a problem creating your PA request.');
          }
        });

        $('#show-dashboard').on('click', function () {
          $('#dashboard').dashboard({
            staging: true,
            // Use the stored IDs from earlier ^
            ids: JSON.parse(localStorage.getItem('ids')) || ['PM4EM4', 'WM9QN7', 'FK9HU3']
         });
        });

        $('#help').showHelp();
      });
    </script>
  </head>
  <body>
    <form action="#">
      <p>
        <label for="patient-fname">Patient First Name</label>
        <input type="text" id="patient-fname" name="request[patient][first_name]" class="form-control">
      </p>
      <p>
        <label for="patient-lname">Patient Last Name</label>
        <input type="text" id="patient-lname" name="request[patient][last_name]" class="form-control">
      </p>
      <p>
        <label for="patient-dob">Patient Date of Birth</label>
        <input type="text" id="patient-dob" name="request[patient][date_of_birth]" class="form-control">
      </p>
      <p>
        <label for="state">Patient State</label>
        <select id="state" name="request[state]" class="form-control">
          <option>Select a state</option>
          <option value="OH">Ohio</option>
        </select>
      </p>
      <p>
        <label for="drug-search">Drug</label>
        <input type="hidden" id="drug-search" name="request[drug_id]" class="form-control">
      </p>
      <p>
        <label for="form-search">Form</label>
        <input type="hidden" id="form-search" name="request[form_id]" class="form-control">
      </p>
      <p>
        <button type="submit" id="start-request" class="btn btn-primary btn-lg">Start PA Request</button>
      </p>
    </form>

    <button id="show-dashboard" class="btn btn-default">Show Dashboard</button>
    <div id="dashboard" class="col-lg-12"></div>

    <div id="help" class="col-lg-12">
    </div>
  </body>
</html>
